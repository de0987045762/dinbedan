# dinbedan
# Firebase 戰報管理示範

這個專案提供輕量的 Firebase 儀表板示範，登入後即可在 Firestore 讀寫公告、據點、戰報、菜單、排班、許願與商城申請資料，並即時反映變更。
指定的超級管理員帳號 `k987045762@gmail.com` 登入後會自動取得完整權限，其餘帳號預設為員工；如有需要，超級管理員可調整每位員工能操作的功能。

## 立即試用

1. 於專案目錄啟動任何靜態伺服器，例如：

   ```bash
   npx http-server .
   ```

2. 開啟瀏覽器造訪顯示的網址 (預設為 <http://127.0.0.1:8080>)。
3. 在 Firebase Console 建立 Email/Password 帳號並啟用 Email/Password 登入方式。
   若未啟用，登入時會出現 `auth/configuration-not-found` 錯誤。
4. 使用實際的 Firebase 帳號登入。當 Email 為 `k987045762@gmail.com` 時，系統會自動在 `users/{uid}` 文件寫入
   `role: "admin"` 與完整功能權限；其他帳號預設為 `role: "staff"`，但仍可操作日常功能。

## 功能說明

- **人員管理 (管理員專用)**：輸入 Firebase Authentication 的 UID 建立或維護 `users/{uid}` 文件，設定角色、功能權限，並即時反映於前端。
- **公告管理 (管理員專用)**：新增公告、即時監聽 Firestore 並顯示最新內容，支援刪除。
- **據點管理 (管理員專用)**：建立營運據點並同步更新給戰報與菜單表單使用。
- **戰報**：所有登入者皆可新增戰報。管理員可以刪除任何戰報，員工僅能刪除自己提交的紀錄。
- **菜單管理**：員工可記錄每日菜單、數量與備註；管理員或本人可刪除紀錄。
- **排班管理**：員工可登錄班表資訊，支援即時監聽與本人刪除。
- **許願池**：員工可提交願望並於列表中檢視，管理員或本人可刪除。
- **點數商城申請**：員工可提出兌換申請，管理員或本人可刪除。
- **儀表板概況**：即時計算戰報筆數、本月營收總額、菜單紀錄與人員數量。
- **即時監聽**：所有清單與統計皆透過 `onSnapshot` 監聽 Firestore，即時反映資料變更。

## Firestore 規則

範例規則檔位於 `firestore.rules`，重點包含：

- 以 Email 判斷超級管理員 (`k987045762@gmail.com`) 並賦予 `isAdmin()` 權限。
- 允許管理員 (含超級管理員) 建立、更新與刪除任何使用者文件；員工僅能維護自己的檔案且不得自行變更角色。
- 員工可以讀取所有資料、建立自己的戰報、菜單、排班、願望與商城申請，並刪除本人資料。

部署至 Firebase 前，可先在 Firebase Console 的 Rules Simulator 測試不同 Email 與角色的讀寫情境。

## 檔案結構

- `index.html`：登入畫面與資料管理 UI。
- `styles.css`：簡易佈景與按鈕樣式。
- `app.js`：Firebase 初始化、登入流程、Firestore 讀寫與監聽邏輯。
- `firestore.rules`：對應的 Firestore 安全性規則。

若需擴充功能 (例如更多欄位或統計)，可在 `app.js` 中調整表單欄位並依需求同步更新 Firestore 規則。
